{% load blog_extras %}
<div class="sidebar-container">
    <div class="blog-sidebar-header">
        <h3 class="sidebar-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sidebar-icon" aria-hidden="true"><path d="M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"></path></svg>
        Filters
    </h3>
    </div>

    <!-- Saved Toggle -->
    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 2rem; padding-bottom: 1.5rem; border-bottom: 1px solid #F1F5F9;">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="{% if active_filters.saved %}#F59E0B{% else %}none{% endif %}" stroke="{% if active_filters.saved %}#F59E0B{% else %}currentColor{% endif %}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: #94A3B8;"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
            <span class="sidebar-title" style="margin: 0; font-size: 1rem;">Saved Posts</span>
        </div>
        
        {% with is_saved=active_filters.saved %}
        <label class="toggle-switch" style="position: relative; display: inline-block; width: 50px; height: 26px; margin: 0;">
            <input type="checkbox" 
                   name="saved" 
                   {% if is_saved %}checked{% endif %}
                   hx-get="?{% if is_saved %}saved={% else %}saved=on{% endif %}"
                   hx-target="#blog-grid-container"
                   hx-indicator="#blog-grid-container"
                   hx-push-url="true"
                   hx-trigger="change">
            <span class="toggle-slider"></span>
        </label>
        {% endwith %}
    </div>

    <!-- Ecosystem -->
    <div class="filter-group">
        <div class="filter-group-title">Ecosystem</div>
        <div class="filter-chips">
            {% for vendor in ecosystem_vendors %}
            <a href="?{% toggle_url 'ecosystem' vendor %}"
               class="filter-chip {% if vendor in active_filters.ecosystem %}active{% endif %}"
               hx-get="?{% toggle_url 'ecosystem' vendor %}"
               hx-target="#blog-grid-container"
               hx-indicator="#blog-grid-container"
               hx-push-url="true">
                {{ vendor }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Content Type (Tags) -->
    <div class="filter-group">
        <div class="filter-group-title">Content Type</div>
        <div class="filter-chips">
            {% for tag in tags|slice:":8" %}
            <a href="?{% toggle_url 'tag' tag %}"
               class="filter-chip {% if tag in active_filters.tag %}active{% endif %}"
               hx-get="?{% toggle_url 'tag' tag %}"
               hx-target="#blog-grid-container"
               hx-indicator="#blog-grid-container"
               hx-push-url="true">
                {{ tag }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Experience Level -->
    <div class="filter-group">
        <div class="filter-group-title">Experience Level</div>
        <div class="filter-chips">
            {% for code, label in experience_levels %}
            <a href="?{% toggle_url 'experience_level' code %}"
               class="filter-chip {% if code in active_filters.experience_level %}active{% endif %}"
               hx-get="?{% toggle_url 'experience_level' code %}"
               hx-target="#blog-grid-container"
               hx-indicator="#blog-grid-container"
               hx-push-url="true">
                {{ label }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Read Time -->
    <div class="filter-group">
        <div class="filter-group-title">Read Time</div>
        <div class="filter-chips">
            {% for code, label in read_times %}
            <a href="?{% toggle_url 'read_time' code %}"
               class="filter-chip {% if code in active_filters.read_time %}active{% endif %}"
               hx-get="?{% toggle_url 'read_time' code %}"
               hx-target="#blog-grid-container"
               hx-indicator="#blog-grid-container"
               hx-push-url="true">
                {{ label }}
            </a>
            {% endfor %}
        </div>
    </div>
</div>

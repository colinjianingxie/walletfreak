{% extends 'auth_base.html' %}
{% load static %}

{% block extra_css %}
<style>
    .form-group {
        margin-bottom: 1.5rem;
    }
    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #1F2937;
        font-size: 0.875rem;
    }
    .form-input, .form-textarea, .form-select {
        width: 100%;
        padding: 0.875rem 1rem;
        border: 1px solid #E5E7EB;
        border-radius: 12px;
        font-size: 1rem;
        color: #1F2937;
        transition: all 0.2s;
    }
    .form-input:focus, .form-textarea:focus, .form-select:focus {
        outline: none;
        border-color: #6366F1;
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }
    .form-textarea {
        resize: vertical;
        min-height: 300px;
        font-family: inherit;
        line-height: 1.6;
    }
    .btn-primary {
        background: #6366F1;
        color: white;
        padding: 0.875rem 1.5rem;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }
    .btn-primary:hover {
        background: #4F46E5;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }
    .btn-secondary {
        background: #F3F4F6;
        color: #64748B;
        padding: 0.875rem 1.5rem;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        transition: all 0.2s;
    }
    .btn-secondary:hover {
        background: #E5E7EB;
    }
    .btn-danger {
        background: #FEE2E2;
        color: #DC2626;
        padding: 0.875rem 1.5rem;
        border: 1px solid #FCA5A5;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }
    .btn-danger:hover {
        background: #FCA5A5;
        color: white;
    }
    .error-message {
        background: #FEE2E2;
        color: #DC2626;
        padding: 1rem;
        border-radius: 12px;
        margin-bottom: 1.5rem;
        font-weight: 600;
    }
    .meta-info {
        background: #F9FAFB;
        padding: 1rem;
        border-radius: 12px;
        margin-bottom: 1.5rem;
        font-size: 0.875rem;
        color: #64748B;
    }
</style>
{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 0 auto; padding: 2rem 1rem;">
    <!-- Header -->
    <div style="margin-bottom: 2rem;">
        <h1 style="font-size: 2rem; font-weight: 800; margin: 0 0 0.5rem 0; color: #1F2937;">Edit Blog Post</h1>
        <p style="color: #64748B; margin: 0;">Update your blog post content and settings.</p>
    </div>

    {% if error %}
    <div class="error-message">{{ error }}</div>
    {% endif %}

    <!-- Meta Info -->
    <div class="meta-info">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div>
                <strong>Author:</strong> {{ blog.author_name }}
            </div>
            <div>
                <strong>Created:</strong> {{ blog.created_at|date:"M d, Y" }}
            </div>
            <div>
                <strong>Last Updated:</strong> {{ blog.updated_at|date:"M d, Y" }}
            </div>
            {% if blog.published_at %}
            <div>
                <strong>Published:</strong> {{ blog.published_at|date:"M d, Y" }}
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Form -->
    <form method="POST" style="background: white; border-radius: 24px; padding: 2rem; border: 1px solid #F3F4F6; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label" for="title">Title *</label>
            <input type="text" id="title" name="title" class="form-input" required value="{{ blog.title }}">
        </div>

        <div class="form-group">
            <label class="form-label" for="excerpt">Excerpt</label>
            <textarea id="excerpt" name="excerpt" class="form-textarea" rows="3" placeholder="Brief description for preview (optional)" style="min-height: 100px;">{{ blog.excerpt }}</textarea>
        </div>

        <div class="form-group">
            <label class="form-label" for="content">Content * (Markdown Supported)</label>
            <textarea id="content" name="content" class="form-textarea" required>{{ blog.content }}</textarea>
            <div style="margin-top: 0.5rem; font-size: 0.875rem; color: #64748B;">
                <strong>Markdown Tips:</strong> Use <code>![alt text](image-url)</code> for images, <code>**bold**</code> for bold, <code>_italic_</code> for italic, <code>### Heading</code> for headings
            </div>
        </div>

        <div class="form-group">
            <label class="form-label" for="featured_image">Featured Image URL</label>
            <input type="url" id="featured_image" name="featured_image" class="form-input" value="{{ blog.featured_image }}">
        </div>

        <div class="form-group">
            <label class="form-label" for="tags">Tags</label>
            <input type="text" id="tags" name="tags" class="form-input" value="{{ blog.tags }}" placeholder="credit cards, rewards, travel (comma-separated)">
        </div>

        <div class="form-group">
            <label class="form-label" for="status">Status *</label>
            <select id="status" name="status" class="form-select">
                <option value="draft" {% if blog.status == 'draft' %}selected{% endif %}>Draft</option>
                <option value="published" {% if blog.status == 'published' %}selected{% endif %}>Published</option>
                <option value="archived" {% if blog.status == 'archived' %}selected{% endif %}>Archived</option>
            </select>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
            <button type="submit" class="btn-primary">
                <span style="display: flex; align-items: center; gap: 0.5rem;">
                    <span class="material-icons" style="font-size: 20px;">save</span>
                    Save Changes
                </span>
            </button>
            <a href="{% url 'blog_detail' blog.slug %}" class="btn-secondary">Cancel</a>
            <div style="margin-left: auto;">
                <button type="button" class="btn-danger" onclick="if(confirm('Are you sure you want to delete this blog post? This action cannot be undone.')) { document.getElementById('delete-form').submit(); }">
                    <span style="display: flex; align-items: center; gap: 0.5rem;">
                        <span class="material-icons" style="font-size: 20px;">delete</span>
                        Delete Post
                    </span>
                </button>
            </div>
        </div>
    </form>
    
    <form id="delete-form" method="POST" action="{% url 'blog_delete' blog.slug %}" style="display: none;">
        {% csrf_token %}
    </form>
</div>
{% endblock %}

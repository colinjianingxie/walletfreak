{% extends 'base.html' %}

{% block content %}
<!-- Quiz Container with Dark Navy Background -->
<div
    style="background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 4rem 0; position: relative; overflow: hidden;">
    <!-- Background pattern -->
    <div
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.03; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px);">
    </div>

    <div class="container" style="max-width: 1200px; position: relative; z-index: 1;">
        <div id="quiz-container" style="text-align: center;">
            <!-- Badge -->
            <div
                style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(139, 92, 246, 0.2); padding: 0.5rem 1.25rem; border-radius: 999px; margin-bottom: 2rem; backdrop-filter: blur(10px); border: 1px solid rgba(139, 92, 246, 0.3);">
                <span style="font-size: 1.2rem;">âœ¨</span>
                <span style="color: #c4b5fd; font-size: 0.85rem; font-weight: 600; letter-spacing: 0.1em;">DISCOVER YOUR
                    FINANCIAL DNA</span>
            </div>

            <!-- Title -->
            <h1
                style="font-size: clamp(2.5rem, 6vw, 4rem); font-weight: 700; line-height: 1.1; margin-bottom: 1.5rem; color: white;">
                What's your <span
                    style="background: linear-gradient(90deg, #a78bfa 0%, #c4b5fd 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Wallet
                    Vibe</span>?
            </h1>

            <!-- Subtitle -->
            <p id="quiz-subtitle"
                style="font-size: 1.125rem; line-height: 1.6; margin-bottom: 3rem; color: rgba(255,255,255,0.7);">
                Click the statement that sounds most like you.
            </p>

            <!-- Question Text -->
            <h2 id="question-text"
                style="font-size: 1.25rem; font-weight: 500; margin-bottom: 2.5rem; color: rgba(255,255,255,0.9); line-height: 1.4;">
            </h2>

            <!-- Options Container - 5 Cards in a Row -->
            <div id="options-container"
                style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 3rem;">
                <!-- Options will be injected here -->
            </div>

            <!-- Next Button -->
            <button id="next-btn" class="btn"
                style="display: none; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; padding: 1rem 3rem; font-size: 1.1rem; font-weight: 600; box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4); border: none;"
                onclick="nextQuestion()">
                Continue â†’
            </button>
        </div>
    </div>
</div>

<script>
    const questions = [
        {
            question: "What describes you best when it comes to credit cards?",
            options: [
                { text: "I live for free flights & lounges", icon: "âœˆï¸", type: "jetsetter" },
                { text: "Cash is king. Fees are evil.", icon: "ðŸ’µ", type: "minimalist" },
                { text: "Dining out & VIP events", icon: "ðŸ½ï¸", type: "foodie" },
                { text: "Maximize ROI. Optimize everything", icon: "ðŸ“Š", type: "strategist" },
                { text: "I have a spreadsheet for everything", icon: "âš¡", type: "optimizer" }
            ]
        },
        {
            question: "How do you feel about annual fees?",
            options: [
                { text: "Worth it for premium travel perks", icon: "âœˆï¸", type: "jetsetter" },
                { text: "I avoid them at all costs", icon: "ðŸš«", type: "minimalist" },
                { text: "Fine if dining credits offset the cost", icon: "ðŸ½ï¸", type: "foodie" },
                { text: "I calculate the exact ROI", icon: "ðŸ“Š", type: "strategist" },
                { text: "I track every dollar of value", icon: "âš¡", type: "optimizer" }
            ]
        },
        {
            question: "What's your biggest spending category?",
            options: [
                { text: "Travel: flights, hotels, experiences", icon: "âœˆï¸", type: "jetsetter" },
                { text: "Essentials: groceries and gas", icon: "ðŸ›’", type: "minimalist" },
                { text: "Restaurants and food delivery", icon: "ðŸ½ï¸", type: "foodie" },
                { text: "Everything - I optimize by category", icon: "ðŸ“Š", type: "strategist" },
                { text: "I diversify across multiple cards", icon: "âš¡", type: "optimizer" }
            ]
        }
    ];

    let currentQuestion = 0;
    const scores = {};

    function loadQuestion() {
        const q = questions[currentQuestion];
        document.getElementById('question-text').innerText = q.question;
        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';
        document.getElementById('next-btn').style.display = 'none';

        q.options.forEach((opt, index) => {
            const optionCard = document.createElement('div');
            optionCard.className = 'option-card';
            optionCard.dataset.value = opt.type;
            optionCard.style.cssText = `
                background: rgba(255,255,255,0.05);
                border: 2px solid rgba(255,255,255,0.1);
                border-radius: 16px;
                padding: 2rem 1rem;
                cursor: pointer;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                min-height: 180px;
            `;

            const iconSpan = document.createElement('div');
            iconSpan.style.cssText = `
                font-size: 3rem;
                margin-bottom: 1rem;
            `;
            iconSpan.textContent = opt.icon;

            const textSpan = document.createElement('div');
            textSpan.style.cssText = `
                color: white;
                font-size: 0.95rem;
                font-weight: 500;
                line-height: 1.4;
            `;
            textSpan.textContent = opt.text;

            optionCard.appendChild(iconSpan);
            optionCard.appendChild(textSpan);

            // Click handler
            optionCard.onclick = () => {
                // Remove selected state from all cards
                document.querySelectorAll('.option-card').forEach(card => {
                    card.style.background = 'rgba(255,255,255,0.05)';
                    card.style.borderColor = 'rgba(255,255,255,0.1)';
                    card.style.transform = 'scale(1)';
                    card.classList.remove('selected');
                });

                // Add selected state to clicked card
                optionCard.classList.add('selected');
                optionCard.style.background = 'linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(124, 58, 237, 0.3))';
                optionCard.style.borderColor = '#8b5cf6';
                optionCard.style.transform = 'scale(1.05)';
                optionCard.style.boxShadow = '0 8px 24px rgba(139, 92, 246, 0.4)';

                // Show next button
                document.getElementById('next-btn').style.display = 'inline-block';
            };

            optionsContainer.appendChild(optionCard);
        });
    }

    function nextQuestion() {
        // Collect answer
        const selected = document.querySelector('.option-card.selected');
        if (selected) {
            const type = selected.dataset.value;
            scores[type] = (scores[type] || 0) + 1;
        }

        currentQuestion++;

        if (currentQuestion < questions.length) {
            loadQuestion();
        } else {
            // Calculate personality
            let maxScore = 0;
            let personality = 'jetsetter'; // default

            for (const [type, score] of Object.entries(scores)) {
                if (score > maxScore) {
                    maxScore = score;
                    personality = type;
                }
            }

            // Redirect to personality detail page
            window.location.href = `/personalities/${personality}/`;
        }
    }

    // Load first question
    loadQuestion();
</script>

<style>
    @media (max-width: 1024px) {
        #options-container {
            grid-template-columns: repeat(3, 1fr) !important;
        }
    }

    @media (max-width: 768px) {
        #options-container {
            grid-template-columns: 1fr !important;
        }

        .option-card {
            min-height: 140px !important;
            padding: 1.5rem 1rem !important;
        }
    }
</style>
{% endblock %}